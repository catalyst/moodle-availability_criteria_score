YUI.add("moodle-availability_criteria_score-form",function(o,e){M.availability_criteria_score=M.availability_criteria_score||{},M.availability_criteria_score.form=o.Object(M.core_availability.plugin),M.availability_criteria_score.form.gradeitems=null,M.availability_criteria_score.form.initInner=function(e){this.gradeitems=e},M.availability_criteria_score.form.getNode=function(e){for(var i,a,t,r='<label class="form-group"><span class="p-r-1">Grade Item</span> <span class="availability-criterion"><select name="gradeitemid" class="custom-select"><option value="0">'+M.util.get_string("choosedots","moodle")+"</option>",l=0;l<this.gradeitems.length;l++)r+='<option value="'+(i=this.gradeitems[l]).id+'">'+i.name+"</option>";return r=(r=(r+="</select></span></label>")+('<label><span class="p-r-1">'+M.util.get_string("choosecriteria","availability_criteria_score")+'</span> <span class="availability-criteria_score"><select name="criterion" class="custom-select"><option value="choose">'+M.util.get_string("choosedots","moodle")+"</option></select></span></label>"))+('<br><span class="availability-group form-group"><label><input type="checkbox" class="form-check-input mx-1" name="min" />'+M.util.get_string("option_min","availability_criteria_score")+'</label><label><span class="accesshide">'+M.util.get_string("label_min","availability_criteria_score")+'</span><input type="text" class="form-control mx-1" name="minval" title="'+M.util.get_string("label_min","availability_criteria_score")+'"></label><label><input type="checkbox" class="form-check-input mx-1" name="max" />'+M.util.get_string("option_max","availability_criteria_score")+'</label><label><span class="accesshide">'+M.util.get_string("label_max","availability_criteria_score")+'</span><input type="text" class="form-control mx-1" name="maxval" title="'+M.util.get_string("label_max","availability_criteria_score")+'"></label></span>'),a=o.Node.create('<span class="form-inline">'+r+"</span>"),e.gradeitemid!==undefined&&a.one("select[name=gradeitemid] > option[value="+e.gradeitemid+"]")?(a.one("select[name=gradeitemid]").set("value",""+e.gradeitemid),M.availability_criteria_score.fillCriterion(a)):e.gradeitemid===undefined&&a.one("select[name=gradeitemid]").set("value","choose"),e.criterion!==undefined&&a.one("select[name=criterion] > option[value="+e.criterion+"]")?(a.one("select[name=criterion]").set("value",""+e.criterion),M.availability_criteria_score.unlockScores(a)):e.criterion===undefined&&a.one("select[name=criterion]").set("value","choose"),e.min!==undefined&&(a.one("input[name=min]").set("checked",!0),a.one("input[name=minval]").set("value",e.min)),e.max!==undefined&&(a.one("input[name=max]").set("checked",!0),a.one("input[name=maxval]").set("value",e.max)),t=function(e,i){var a=e.ancestor("label").next("label").one("input"),e=e.get("checked");return a.set("disabled",!e),i&&e&&a.focus(),e},a.all("input[type=checkbox]").each(t),M.availability_criteria_score.form.addedEvents||(M.availability_criteria_score.form.addedEvents=!0,e=o.one(".availability-field"),a.one("select[name=gradeitemid]").delegate("change",function(){M.availability_criteria_score.fillCriterion(a),M.core_availability.form.update()},".availability_criteria_score select"),a.one("select[name=criterion]").delegate("change",function(){M.availability_criteria_score.unlockScores(a),M.core_availability.form.update()},".availability_criteria_score select"),e.delegate("click",function(){t(this,!0),M.core_availability.form.update()},".availability_criteria_score input[type=checkbox]"),e.delegate("valuechange",function(){M.core_availability.form.update()},".availability_criteria_score input[type=text]")),a},M.availability_criteria_score.form.fillValue=function(e,i){var a=i.one("select[name=gradeitemid]").get("value");e.gradeitemid="choose"===a?null:parseInt(a,10),a=i.one("select[name=criterion]").get("value"),e.criterion="choose"===a?null:parseInt(a,10),i.one("input[name=min]").get("checked")&&(e.min=this.getValue("minval",i)),i.one("input[name=max]").get("checked")&&(e.max=this.getValue("maxval",i))},M.availability_criteria_score.form.getValue=function(e,i){e=i.one("input[name="+e+"]").get("value");return!/^[0-9]+([.,][0-9]+)?$/.test(e)||(i=parseFloat(e.replace(",",".")))<0||100<i?e:i},M.availability_criteria_score.form.fillErrors=function(e,i){var a={};this.fillValue(a,i),(a.gradeitemid&&"choose"===a.gradeitemid||a.criterion&&"choose"===a.criterion)&&e.push("availability_criteria_score:error_selectcriterion")},M.availability_criteria_score.fillCriterion=function(e){var i,a,t,m,r,l,o,n,c,s=e.one("select[name=gradeitemid]").get("value");if("choose"!==s){for(i=parseInt(s,10),a=null,t=0;t<M.availability_criteria_score.form.gradeitems.length;t++)if((m=M.availability_criteria_score.form.gradeitems[t]).id==i){a=m;break}if(null!==a){for(l=(r=e.one("select[name=criterion]").getDOMNode()).options.length-1;0<=l;l--)r.remove(l);for((s=document.createElement("option")).value="choose",s.text=M.util.get_string("choosedots","moodle"),r.add(s),o=0;o<a.criteria.length;o++)n=a.criteria[o],(c=document.createElement("option")).value=n.id,c.text=n.shortname,r.add(c)}}},M.availability_criteria_score.unlockScores=function(e){}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});